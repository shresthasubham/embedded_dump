ORG 0000H

TEMP1 EQU 50H
TEMP2 EQU 51H
TEMP_LOOPER1 EQU 52H
TEMP_LOOPER2 EQU 53H

MOV 20H, #03FH
MOV 21H, #006H
MOV 22H, #05BH
MOV 23H, #04FH
MOV 24H, #066H
MOV 25H, #06DH
MOV 26H, #07DH
MOV 27H, #007H
MOV 28H, #07FH
MOV 29H, #06FH

MOV 30H, #03FH
MOV 31H, #007H
MOV 32H, #007H
MOV 33H, #07CH
MOV 34H, #079H
MOV 35H, #030H

LOOP:
MOV A, #0H
INCREASING:
INC A
MOV R3, A

MOV R1, #38H
LCALL EXTRACT_DIGITS3

MOV TEMP_LOOPER1, #09H
DISPLAY_SHIFTED:
LCALL DISPLAY_CHAR4
MOV R0, #30H
LCALL SHIFT_ARRAY_LEFT
DJNZ TEMP_LOOPER1, DISPLAY_SHIFTED

MOV A, R3
CJNE A, #018H, INCREASING
JMP LOOP


DISPLAY_CHAR4:
MOV R7, #0FFH
INNER:
MOV R1, #30H
MOV R2, #01H

MOV R4, #04H
NEXT_DIGIT:
MOV P2, #0H
MOV P0, @R1
MOV P2, R2

XCH A, R2
RL A
XCH A, R2
INC R1
DJNZ R4, NEXT_DIGIT

DJNZ R7, INNER
RET

SHIFT_ARRAY_LEFT:
MOV TEMP1, @R0
MOV A, R0
MOV R1, A
MOV TEMP_LOOPER2, #08H
NEXT_SHIFT:
INC R1
MOV TEMP2, @R1
MOV @R0, TEMP2
INC R0
DJNZ TEMP_LOOPER2, NEXT_SHIFT

MOV @R0, TEMP1
RET


EXTRACT_DIGITS3:
MOV R4, #03H

EXTRACT_NEXT_DIGIT:
MOV B, #0AH
DIV AB
XCH A, R6

MOV A, #020H
ADD A, B
MOV R0, A
MOV A, @R0
MOV @R1, A
DEC R1

XCH A, R6
DJNZ R4, EXTRACT_NEXT_DIGIT

INC R1
INC R1
INC R1
MOV A, @R1
ORL A, #080H
MOV @R1, A
RET

END