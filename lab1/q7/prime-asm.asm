ORG 0000H

MOV A, #0H
MOV R0, #040H
MOV R1, #020H
STORE_NEXT:
MOV @R0, A
INC R0
INC A
DJNZ R1, STORE_NEXT

MOV R0, #040H   ;source
MOV R2, #020H	;length
MOV R1, #020H	;store primes here
LCALL EXTRACT_PRIME

AGAIN:
JMP AGAIN


EXTRACT_PRIME:
NEXT:
MOV A, @R0
LCALL CHECK_PRIME_AND_WRITE
MOV P0,A
INC R0

DJNZ R2, NEXT
RET


CHECK_PRIME_AND_WRITE:
MOV R4, A
CJNE A, #02H, NOT_EQUAL
NOT_EQUAL: JC DONE             ; FILTERING NUMBERS LESS THAN 2

MOV R5, A
DEC R5
MOV A, R5
SUBB A, #02H
JC DONE

LOOP:
MOV A, R4
MOV B, R5
DIV AB
MOV A, B
JZ TIS_NOT_PRIME

DEC R5
MOV A, R5
SUBB A, #02H
JNC LOOP

TIS_PRIME:
MOV A, R4
MOV @R1, A
INC R1

TIS_NOT_PRIME:
DONE:
RET

END
